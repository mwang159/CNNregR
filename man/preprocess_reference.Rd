% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/preprocess.R
\name{preprocess_reference}
\alias{preprocess_reference}
\title{Preprocess Reference scRNA-seq Data (K-means Clustering)}
\usage{
preprocess_reference(
  sc_counts_list,
  bulk_df,
  genes,
  n_clusters = 5,
  quantile_norm = 0.99,
  seed = 1235,
  output_file = NULL
)
}
\arguments{
\item{sc_counts_list}{Named list of scRNA-seq count matrices per cell type (cells Ã— genes)}

\item{bulk_df}{Preprocessed bulk data.frame (output from preprocess_bulk)}

\item{genes}{Character vector of genes to include. Should be bulk_df$Gene from preprocess_bulk output
to ensure genes match between bulk and reference after final CV filtering.}

\item{n_clusters}{Number of k-means clusters per cell type (default: 5)}

\item{quantile_norm}{Quantile for normalization (default: 0.99)}

\item{seed}{Random seed for k-means (default: 1235)}

\item{output_file}{Path to save CSV file (optional)}
}
\value{
Data.frame with format: Sample, Gene1_CellType1, Gene1_CellType2, ...
}
\description{
Creates reference Cell-type Specific Expression (CSE) profiles using
k-means clustering. Generates reference samples by clustering cells within
each cell type and matching expression scales to bulk samples.
}
\examples{
\dontrun{
# Complete workflow
gene_result <- select_genes(bulk_data, sc_list)
bulk_df <- preprocess_bulk(bulk_data, gene_result$genes, gene_result$size_factors)

# Use genes from bulk_df output (after final CV filtering)
ref_df <- preprocess_reference(
  sc_counts_list = sc_list,
  bulk_df = bulk_df,
  genes = bulk_df$Gene,
  n_clusters = 5,
  output_file = "ref_processed.csv"
)
}
}
